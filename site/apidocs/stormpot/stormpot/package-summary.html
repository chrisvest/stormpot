<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (11.0.4) on Tue Nov 05 23:30:03 CET 2019 -->
<title>stormpot (stormpot 3.0 API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2019-11-05">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
<script type="text/javascript" src="../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../jquery/jquery-3.3.1.js"></script>
<script type="text/javascript" src="../../jquery/jquery-migrate-3.0.1.js"></script>
<script type="text/javascript" src="../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="stormpot (stormpot 3.0 API)";
        }
    }
    catch(err) {
    }
//-->
var pathtoroot = "../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../module-summary.html">Module</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<main role="main">
<div class="header">
<div class="subTitle"><span class="moduleLabelInPackage">Module</span>&nbsp;<a href="../module-summary.html">stormpot</a></div>
<h1 title="Package" class="title">Package&nbsp;stormpot</h1>
</div>
<div class="contentContainer">
<section role="region"><a id="package.description">
<!--   -->
</a>
<div class="block"><h2 id="stormpot">Stormpot</h2>
<div class="sectionbody">
<p>Stormpot is a generic, thread-safe and fast object pooling library.</p>
<p>The object pools themselves implement the <a href="Pool.html" title="class in stormpot"><code>Pool</code></a> interface.
The things you actually want to pool must all implement the
<a href="Poolable.html" title="interface in stormpot"><code>Poolable</code></a> interface, and you must also provide an
implementation of the <a href="Allocator.html" title="interface in stormpot"><code>Allocator</code></a> interface as a factory to
create your pooled objects.</p>
</div>
<h2 id="simplest-possible-usage">Simplest Possible Usage</h2>
<div class="sectionbody">
<p>Stormpot has an invasive API which means that there is a minimum of things your code needs to do to use it.
However, the requirements are quite benign, as this section is all about showing you.</p>
<p>The objects that you manage with a Stormpot pool needs to implement the <code>Poolable</code> interface.
The absolute minimum amount of code required for its implementation is this:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// MyPoolable.java - minimum Poolable implementation</span>
<span class="keyword">import</span> <span class="include">stormpot.BasePoolable</span>;
<span class="keyword">import</span> <span class="include">stormpot.Slot</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">MyPoolable</span> <span class="directive">extends</span> BasePoolable {
  <span class="directive">public</span> MyPoolable(Slot slot) {
    <span class="local-variable">super</span>(slot);
  }
}</code></pre>
</div>
</div>
<p>We extend the <code>BasePoolable</code> class, pass a <code>Slot</code> argument through to its constructor, and leave the rest of the implementation to the <code>BasePoolable</code> class.</p>
<p>We can also implement the <code>Poolable</code> interface directly.
Here is an example of how to do this:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// MyOtherPoolable.java - explicit Poolable implementation</span>
<span class="keyword">import</span> <span class="include">stormpot.Poolable</span>;
<span class="keyword">import</span> <span class="include">stormpot.Slot</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">MyOtherPoolable</span> <span class="directive">implements</span> Poolable {
  <span class="directive">private</span> <span class="directive">final</span> Slot slot;
  <span class="directive">public</span> MyOtherPoolable(Slot slot) {
    <span class="local-variable">this</span>.slot = slot;
  }

  <span class="annotation">@Override</span>
  <span class="directive">public</span> <span class="type">void</span> release() {
    slot.release(<span class="local-variable">this</span>);
  }
}</code></pre>
</div>
</div>
<p>The object in essence just needs to keep its <code>Slot</code> instance around, and give itself as a parameter to the <code>Slot#release</code> method.
Now that we have a class of objects to pool, we need some way to tell Stormpot how to create them.
We do this by implementing the <code>Allocator</code> interface:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// MyAllocator.java - minimum Allocator implementation</span>
<span class="keyword">import</span> <span class="include">stormpot.Allocator</span>;
<span class="keyword">import</span> <span class="include">stormpot.Slot</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">MyAllocator</span> <span class="directive">implements</span> Allocator&lt;MyPoolable&gt; {
  <span class="directive">public</span> MyPoolable allocate(Slot slot) <span class="directive">throws</span> <span class="exception">Exception</span> {
    <span class="keyword">return</span> <span class="keyword">new</span> MyPoolable(slot);
  }

  <span class="directive">public</span> <span class="type">void</span> deallocate(MyPoolable poolable) <span class="directive">throws</span> <span class="exception">Exception</span> {
    <span class="comment">// Nothing to do here</span>
    <span class="comment">// But it's a perfect place to close sockets, files, etc.</span>
  }
}</code></pre>
</div>
</div>
<p>That&#8217;s it.
Given a slot, create a <code>MyPoolable</code>.
Or given a <code>MyPoolable</code>, deallocate it.
And that is actually all the parts we need to start using Stormpot.
All that is left is a little bit of configuration:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    Pool&lt;MyPoolable&gt; pool = Pool.from(<span class="keyword">new</span> MyAllocator()).build();
    Timeout timeout = <span class="keyword">new</span> Timeout(<span class="integer">1</span>, <span class="predefined-type">TimeUnit</span>.SECONDS);

    MyPoolable object = pool.claim(timeout);
    <span class="keyword">try</span> {
      <span class="comment">// Do stuff with 'object'.</span>
      <span class="comment">// Note that 'claim' will return 'null' if it times out!</span>
    } <span class="keyword">finally</span> {
      <span class="keyword">if</span> (object != <span class="predefined-constant">null</span>) {
        object.release();
      }
    }</code></pre>
</div>
</div>
<p>We get a <code>PoolBuilder</code> via the <code>Pool.from</code> method, which takes an allocator.
Then we use it to build a pool with the configuration we want, and off we go!</p>
<p>The blocking methods <code>Pool#claim</code> and <code>Completion#await</code> both take <code>Timeout</code> objects as arguments.
These are immutable, and can easily be put in <code>static final</code> constants.</p>
<p>Note that <code>claim</code> returns <code>null</code> if the timeout elapses before an object can be claimed.
Also, using <code>try-finally</code> is a great way to make sure that you don&#8217;t forget to release the objects back into the pool.</p>
<p>Stormpot cannot prevent objects from leaking in user code, so if you lose the reference to an object that hasn&#8217;t been released back into the pool, it will not come back on its own.
Leaked objects can also cause problems with shutting the pool down, because the shut down procedure does not complete until all allocated objects are deallocated.
So if you have leaked objects, shutting the pool down will never complete normally.
You can still just halt the JVM, though.</p>
</div></div>
</section>
<ul class="blockList">
<li class="blockList">
<table class="typeSummary">
<caption><span>Interface Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<th class="colFirst" scope="row"><a href="Allocator.html" title="interface in stormpot">Allocator</a>&lt;T extends <a href="Poolable.html" title="interface in stormpot">Poolable</a>&gt;</th>
<td class="colLast">
<div class="block">An Allocator is responsible for the creation and destruction of
<a href="Poolable.html" title="interface in stormpot"><code>Poolable</code></a> objects.</div>
</td>
</tr>
<tr class="rowColor">
<th class="colFirst" scope="row"><a href="Completion.html" title="interface in stormpot">Completion</a></th>
<td class="colLast">
<div class="block">A Completion represents some task that is going to be completed at some
point in the future, or maybe already has completed.</div>
</td>
</tr>
<tr class="altColor">
<th class="colFirst" scope="row"><a href="Expiration.html" title="interface in stormpot">Expiration</a>&lt;T extends <a href="Poolable.html" title="interface in stormpot">Poolable</a>&gt;</th>
<td class="colLast">
<div class="block">The expiration is used to determine if a given slot has expired, or
otherwise become invalid.</div>
</td>
</tr>
<tr class="rowColor">
<th class="colFirst" scope="row"><a href="ManagedPool.html" title="interface in stormpot">ManagedPool</a></th>
<td class="colLast">
<div class="block">This is the JMX management interface for Stormpot object pools.</div>
</td>
</tr>
<tr class="altColor">
<th class="colFirst" scope="row"><a href="MetricsRecorder.html" title="interface in stormpot">MetricsRecorder</a></th>
<td class="colLast">
<div class="block">A MetricsRecorder implementation supplies the pool with the ability to
record and report operational metrics.</div>
</td>
</tr>
<tr class="rowColor">
<th class="colFirst" scope="row"><a href="Poolable.html" title="interface in stormpot">Poolable</a></th>
<td class="colLast">
<div class="block">Objects contained in a <a href="Pool.html" title="class in stormpot"><code>Pool</code></a> must implement the Poolable interface
and adhere to its contract.</div>
</td>
</tr>
<tr class="altColor">
<th class="colFirst" scope="row"><a href="Reallocator.html" title="interface in stormpot">Reallocator</a>&lt;T extends <a href="Poolable.html" title="interface in stormpot">Poolable</a>&gt;</th>
<td class="colLast">
<div class="block">Reallocators are a special kind of <a href="Allocator.html" title="interface in stormpot"><code>Allocator</code></a> that can reallocate
<a href="Poolable.html" title="interface in stormpot"><code>Poolable</code></a>s that have expired.</div>
</td>
</tr>
<tr class="rowColor">
<th class="colFirst" scope="row"><a href="Slot.html" title="interface in stormpot">Slot</a></th>
<td class="colLast">
<div class="block">A Slot represents a location in a Pool where objects can be allocated into,
so that they can be claimed and released.</div>
</td>
</tr>
<tr class="altColor">
<th class="colFirst" scope="row"><a href="SlotInfo.html" title="interface in stormpot">SlotInfo</a>&lt;T extends <a href="Poolable.html" title="interface in stormpot">Poolable</a>&gt;</th>
<td class="colLast">
<div class="block">An informative interface, used by <a href="Expiration.html" title="interface in stormpot"><code>Expiration</code></a> instances to
determine if a slot has expired or is still invalid for claiming.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<th class="colFirst" scope="row"><a href="BasePoolable.html" title="class in stormpot">BasePoolable</a></th>
<td class="colLast">
<div class="block">A basic implementation of the <a href="Poolable.html" title="interface in stormpot"><code>Poolable</code></a> interface, which can be extended directly.</div>
</td>
</tr>
<tr class="rowColor">
<th class="colFirst" scope="row"><a href="Pool.html" title="class in stormpot">Pool</a>&lt;T extends <a href="Poolable.html" title="interface in stormpot">Poolable</a>&gt;</th>
<td class="colLast">
<div class="block">A Pool is a self-renewable set of objects from which one can claim exclusive
access to elements, until they are released back into the pool.</div>
</td>
</tr>
<tr class="altColor">
<th class="colFirst" scope="row"><a href="PoolBuilder.html" title="class in stormpot">PoolBuilder</a>&lt;T extends <a href="Poolable.html" title="interface in stormpot">Poolable</a>&gt;</th>
<td class="colLast">
<div class="block">The <code>PoolBuilder</code> collects information about how big a pool should be,
and how it should allocate objects, an so on, and finally acts as the
factory for building the pool instances themselves, with the
<a href="PoolBuilder.html#build()"><code>PoolBuilder.build()</code></a> method.</div>
</td>
</tr>
<tr class="rowColor">
<th class="colFirst" scope="row"><a href="Pooled.html" title="class in stormpot">Pooled</a>&lt;T&gt;</th>
<td class="colLast">
<div class="block">A reference to a pooled object.</div>
</td>
</tr>
<tr class="altColor">
<th class="colFirst" scope="row"><a href="PoolTap.html" title="class in stormpot">PoolTap</a>&lt;T extends <a href="Poolable.html" title="interface in stormpot">Poolable</a>&gt;</th>
<td class="colLast">
<div class="block">A PoolTap provides the API for accessing objects in a <a href="Pool.html" title="class in stormpot"><code>Pool</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<th class="colFirst" scope="row"><a href="Timeout.html" title="class in stormpot">Timeout</a></th>
<td class="colLast">
<div class="block">A Timeout represents the maximum amount of time a caller is willing to wait
for a blocking operation to complete.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary">
<caption><span>Exception Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Exception</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<th class="colFirst" scope="row"><a href="PoolException.html" title="class in stormpot">PoolException</a></th>
<td class="colLast">
<div class="block">The PoolException may be thrown by a pool implementation in a number of
circumstances:</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
</div>
</main>
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../module-summary.html">Module</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &#169; 2011-2019&#x2013;2019. All rights reserved.</small></p>
</footer>
</body>
</html>
